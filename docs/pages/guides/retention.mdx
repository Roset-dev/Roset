---
title: Trash & Retention
description: "Manage soft-deleted files and retention policies"
---

# Trash & Retention

Roset uses soft-delete: deleted files go to trash and can be restored within the retention period.

## Soft Delete

When you delete a file, it's marked with a `deleted_at` timestamp:

<CodeBlock language="typescript" code={`// Soft delete
await client.nodes.delete(nodeId);

// Node still exists but is hidden
const node = await client.nodes.get(nodeId);
console.log(node.deletedAt); // "2025-01-15T10:30:00Z"`} />

## Restore from Trash

Restore a deleted file before retention expires:

<CodeBlock language="typescript" code={`await client.nodes.restore(nodeId);`} />

<Callout type="note">
  Restore fails if a file with the same name already exists at the original
  location.
</Callout>

## Retention Policies

Each mount has a configurable `retentionDays` setting:

<CodeBlock
  language="typescript"
  code={`await client.mounts.update(mountId, {
  retentionDays: 30, // Keep deleted files for 30 days
});`}
/>

| Value  | Behavior                    |
| ------ | --------------------------- |
| `null` | No auto-purge (manual only) |
| `0`    | Immediate purge             |
| `30`   | Purge after 30 days         |

## Automatic Purge

A background worker purges expired trash:

- Runs hourly (configurable)
- Iterates over all tenants
- Deletes files past retention period
- Removes from object storage

## Manual Purge

Permanently delete a file immediately:

<Callout type="warning">
  Permanent deletion cannot be undone. Files are removed from database and
  object storage.
</Callout>

<CodeBlock
  language="bash"
  code={`# Via API (if retention allows)
DELETE /v1/nodes/:id/permanent`}
/>

## View Retention Info

Get trash statistics for a mount:

<CodeBlock language="typescript" code={`const { retention } = await client.mounts.get(mountId);

console.log(retention.retentionDays); // 30
console.log(retention.trashCount); // 42 files in trash
console.log(retention.oldestTrash); // "2025-01-01T00:00:00Z"`} />

## Compliance Considerations

- Retention prevents premature deletion
- Audit log tracks all delete/restore operations
- Export audit logs for compliance: `GET /v1/audit/export?format=csv`
